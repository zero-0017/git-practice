{"filter":false,"title":"index.html.erb","tooltip":"/Google/app/views/maps/index.html.erb","undoManager":{"mark":39,"position":39,"stack":[[{"start":{"row":0,"column":0},"end":{"row":28,"column":109},"action":"insert","lines":["","<h2>gmap</h2>","<div id='map'></div>","","<style>","#map {","  height: 600px;","  width: 600px;","}","</style>","","<script>","let map","","function initMap(){","  geocoder = new google.maps.Geocoder()","","  map = new google.maps.Map(document.getElementById('map'), {","    center: {lat: 40.7828, lng:-73.9653},","    zoom: 12,","  });","","  marker = new google.maps.Marker({","    position:  {lat: 40.7828, lng:-73.9653},","    map: map","  });","}","</script>","<script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap\" async defer></script>"],"id":1}],[{"start":{"row":28,"column":57},"end":{"row":28,"column":69},"action":"remove","lines":["YOUR_API_KEY"],"id":2},{"start":{"row":28,"column":57},"end":{"row":28,"column":96},"action":"insert","lines":["AIzaSyBdP41sy-1Bd4LE3okwEwSTiEDQgVdsHpA"]}],[{"start":{"row":1,"column":0},"end":{"row":26,"column":1},"action":"remove","lines":["<h2>gmap</h2>","<div id='map'></div>","","<style>","#map {","  height: 600px;","  width: 600px;","}","</style>","","<script>","let map","","function initMap(){","  geocoder = new google.maps.Geocoder()","","  map = new google.maps.Map(document.getElementById('map'), {","    center: {lat: 40.7828, lng:-73.9653},","    zoom: 12,","  });","","  marker = new google.maps.Marker({","    position:  {lat: 40.7828, lng:-73.9653},","    map: map","  });","}"],"id":3},{"start":{"row":1,"column":0},"end":{"row":38,"column":75},"action":"insert","lines":["<h2>gmap</h2>","","<!-- ここから追加 -->","<input id=\"address\" type=\"textbox\" value=\"GeekSalon\">","<input type=\"button\" value=\"Encode\" onclick=\"codeAddress()\">","<!-- ここまで追加-->","","<div id='map'></div>","","<style>","#map {","  height: 600px;","  width: 600px;","}","</style>","","<script>","let map","function initMap(){","  geocoder = new google.maps.Geocoder()","","  map = new google.maps.Map(document.getElementById('map'), {","    center: {lat: 40.7828, lng:-73.9653},","    zoom: 12,","  });","","  marker = new google.maps.Marker({","    position:  {lat: 40.7828, lng:-73.9653},","    map: map","  });","}","// ここから追加 ","let geocoder","","function codeAddress(){","  let inputAddress = document.getElementById('address').value;","","  geocoder.geocode( { 'address': inputAddress}, function(results, status) {"]}],[{"start":{"row":38,"column":75},"end":{"row":39,"column":0},"action":"insert","lines":["",""],"id":4},{"start":{"row":39,"column":0},"end":{"row":39,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":39,"column":2},"end":{"row":39,"column":4},"action":"remove","lines":["  "],"id":5},{"start":{"row":39,"column":0},"end":{"row":39,"column":2},"action":"remove","lines":["  "]}],[{"start":{"row":39,"column":0},"end":{"row":49,"column":1},"action":"insert","lines":["    if (status == 'OK') {","      map.setCenter(results[0].geometry.location);","      var marker = new google.maps.Marker({","          map: map,","          position: results[0].geometry.location","      });","    } else {","      alert('該当する結果がありませんでした：' + status);","    }","  });   ","}"],"id":6}],[{"start":{"row":32,"column":9},"end":{"row":32,"column":10},"action":"remove","lines":[" "],"id":7},{"start":{"row":48,"column":5},"end":{"row":48,"column":8},"action":"remove","lines":["   "]}],[{"start":{"row":6,"column":14},"end":{"row":7,"column":0},"action":"insert","lines":["",""],"id":8}],[{"start":{"row":7,"column":0},"end":{"row":7,"column":37},"action":"insert","lines":["<div id=\"display\">何かが表示される、、、、！</div>"],"id":9}],[{"start":{"row":45,"column":9},"end":{"row":46,"column":0},"action":"insert","lines":["",""],"id":10},{"start":{"row":46,"column":0},"end":{"row":46,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":46,"column":6},"end":{"row":46,"column":68},"action":"insert","lines":["display.textContent = \"検索結果：\" + results[ 0 ].geometry.location"],"id":11}],[{"start":{"row":34,"column":0},"end":{"row":51,"column":1},"action":"remove","lines":["let geocoder","","function codeAddress(){","  let inputAddress = document.getElementById('address').value;","","  geocoder.geocode( { 'address': inputAddress}, function(results, status) {","    if (status == 'OK') {","      map.setCenter(results[0].geometry.location);","      var marker = new google.maps.Marker({","          map: map,","          position: results[0].geometry.location","      });","      display.textContent = \"検索結果：\" + results[ 0 ].geometry.location","    } else {","      alert('該当する結果がありませんでした：' + status);","    }","  });","}"],"id":12},{"start":{"row":34,"column":0},"end":{"row":50,"column":1},"action":"insert","lines":["function codeAddress(){","  let inputAddress = document.getElementById('address').value;","","  geocoder.geocode( { 'address': inputAddress}, function(results, status) {","    if (status == 'OK') {","      map.setCenter(results[0].geometry.location);","      var marker = new google.maps.Marker({","          map: map,","          position: results[0].geometry.location","      });","      // 下の1行を追加 ","      display.textContent = \"検索結果：\" + results[ 0 ].geometry.location","    } else {","      alert('該当する結果がありませんでした：' + status);","    }","  });   ","}"]}],[{"start":{"row":44,"column":16},"end":{"row":44,"column":17},"action":"remove","lines":[" "],"id":13},{"start":{"row":49,"column":5},"end":{"row":49,"column":8},"action":"remove","lines":["   "]}],[{"start":{"row":18,"column":0},"end":{"row":32,"column":1},"action":"remove","lines":["<script>","let map","function initMap(){","  geocoder = new google.maps.Geocoder()","","  map = new google.maps.Map(document.getElementById('map'), {","    center: {lat: 40.7828, lng:-73.9653},","    zoom: 12,","  });","","  marker = new google.maps.Marker({","    position:  {lat: 40.7828, lng:-73.9653},","    map: map","  });","}"],"id":14},{"start":{"row":18,"column":0},"end":{"row":36,"column":1},"action":"insert","lines":["<script>","let map","let geocoder","// 下の1行を追加 ","const display = document.getElementById('display')","","function initMap(){","  geocoder = new google.maps.Geocoder()","","  map = new google.maps.Map(document.getElementById('map'), {","    center: {lat: 40.7828, lng:-73.9653},","    zoom: 12,","  });","","  marker = new google.maps.Marker({","    position:  {lat: 40.7828, lng:-73.9653},","    map: map","  });","}"]}],[{"start":{"row":21,"column":10},"end":{"row":21,"column":11},"action":"remove","lines":[" "],"id":15}],[{"start":{"row":13,"column":10},"end":{"row":13,"column":11},"action":"remove","lines":["6"],"id":16}],[{"start":{"row":13,"column":10},"end":{"row":13,"column":13},"action":"insert","lines":["120"],"id":17}],[{"start":{"row":14,"column":9},"end":{"row":14,"column":10},"action":"remove","lines":["6"],"id":18}],[{"start":{"row":14,"column":9},"end":{"row":14,"column":10},"action":"insert","lines":["1"],"id":19},{"start":{"row":14,"column":10},"end":{"row":14,"column":11},"action":"insert","lines":["2"]},{"start":{"row":14,"column":11},"end":{"row":14,"column":12},"action":"insert","lines":["0"]}],[{"start":{"row":14,"column":11},"end":{"row":14,"column":12},"action":"remove","lines":["0"],"id":20}],[{"start":{"row":13,"column":12},"end":{"row":13,"column":13},"action":"remove","lines":["0"],"id":21}],[{"start":{"row":56,"column":136},"end":{"row":57,"column":0},"action":"insert","lines":["",""],"id":47},{"start":{"row":57,"column":0},"end":{"row":58,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":58,"column":0},"end":{"row":190,"column":7},"action":"insert","lines":["<!DOCTYPE html>","<html lang=\"ja\">","  <head>","    <meta charset=\"utf-8\">","    <title>Placeサーチ</title>","    <style>","      #header {","    \t  background-color: darkblue;","    \t  padding: 3px;","    \t  width: 1195px;","          font-family: Meriyo UI;","          font-size: 14px;","    \t  color: white;","      }","      #target {","        width: 1200px;","        height: 700px;","      }","    </style>","  </head>","","  <body>","    <div id=\"header\"><b>Google Maps - 場所検索</b></div>","    <div>施設名称検索 （例：マチュピチュ、万里の長城）</div>","    <input type=\"text\" id=\"keyword\"><button id=\"search\">検索実行</button>","    <button id=\"clear\">結果クリア</button>","    <div id=\"target\"></div>","","    <script src=\"https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=キーをセット&callback=initMap\" async defer></script>","","    <script>","","      var map;","      var marker;","      var infoWindow;","","      function initMap() {","","        //マップ初期表示の位置設定","        var target = document.getElementById('target');","        var centerp = {lat: 37.67229496806523, lng: 137.88838989062504};","","        //マップ表示","        map = new google.maps.Map(target, {","          center: centerp,","          zoom: 2,","        });","","        // 検索実行ボタンが押下されたとき","        document.getElementById('search').addEventListener('click', function() {","","          var place = document.getElementById('keyword').value;","          var geocoder = new google.maps.Geocoder();      // geocoderのコンストラクタ","","          geocoder.geocode({","            address: place","          }, function(results, status) {","            if (status == google.maps.GeocoderStatus.OK) {","","              var bounds = new google.maps.LatLngBounds();","","              for (var i in results) {","                if (results[0].geometry) {","                  // 緯度経度を取得","                  var latlng = results[0].geometry.location;","                  // 住所を取得","                  var address = results[0].formatted_address;","                  // 検索結果地が含まれるように範囲を拡大","                  bounds.extend(latlng);","                  // マーカーのセット","                  setMarker(latlng);","                  // マーカーへの吹き出しの追加","                  setInfoW(place, latlng, address);","                  // マーカーにクリックイベントを追加","                  markerEvent();","                }","              }","            } else if (status == google.maps.GeocoderStatus.ZERO_RESULTS) {","              alert(\"見つかりません\");","            } else {","              console.log(status);","              alert(\"エラー発生\");","            }","          });","","        });","","        // 結果クリアーボタン押下時","        document.getElementById('clear').addEventListener('click', function() {","          deleteMakers();","        });","","      }","","      // マーカーのセットを実施する","      function setMarker(setplace) {","        // 既にあるマーカーを削除","        deleteMakers();","","        var iconUrl = 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png';","          marker = new google.maps.Marker({","            position: setplace,","            map: map,","            icon: iconUrl","          });","        }","","        //マーカーを削除する","        function deleteMakers() {","          if(marker != null){","            marker.setMap(null);","          }","          marker = null;","        }","","        // マーカーへの吹き出しの追加","        function setInfoW(place, latlng, address) {","          infoWindow = new google.maps.InfoWindow({","          content: \"<a href='http://www.google.com/search?q=\" + place + \"' target='_blank'>\" + place + \"</a><br><br>\" + latlng + \"<br><br>\" + address + \"<br><br><a href='http://www.google.com/search?q=\" + place + \"&tbm=isch' target='_blank'>画像検索 by google</a>\"","        });","      }","","      // クリックイベント","      function markerEvent() {","        marker.addListener('click', function() {","          infoWindow.open(map, marker);","        });","      }","","    </script>","","  </body>","</html>"],"id":48}],[{"start":{"row":80,"column":0},"end":{"row":187,"column":13},"action":"remove","lines":["    <div id=\"header\"><b>Google Maps - 場所検索</b></div>","    <div>施設名称検索 （例：マチュピチュ、万里の長城）</div>","    <input type=\"text\" id=\"keyword\"><button id=\"search\">検索実行</button>","    <button id=\"clear\">結果クリア</button>","    <div id=\"target\"></div>","","    <script src=\"https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=キーをセット&callback=initMap\" async defer></script>","","    <script>","","      var map;","      var marker;","      var infoWindow;","","      function initMap() {","","        //マップ初期表示の位置設定","        var target = document.getElementById('target');","        var centerp = {lat: 37.67229496806523, lng: 137.88838989062504};","","        //マップ表示","        map = new google.maps.Map(target, {","          center: centerp,","          zoom: 2,","        });","","        // 検索実行ボタンが押下されたとき","        document.getElementById('search').addEventListener('click', function() {","","          var place = document.getElementById('keyword').value;","          var geocoder = new google.maps.Geocoder();      // geocoderのコンストラクタ","","          geocoder.geocode({","            address: place","          }, function(results, status) {","            if (status == google.maps.GeocoderStatus.OK) {","","              var bounds = new google.maps.LatLngBounds();","","              for (var i in results) {","                if (results[0].geometry) {","                  // 緯度経度を取得","                  var latlng = results[0].geometry.location;","                  // 住所を取得","                  var address = results[0].formatted_address;","                  // 検索結果地が含まれるように範囲を拡大","                  bounds.extend(latlng);","                  // マーカーのセット","                  setMarker(latlng);","                  // マーカーへの吹き出しの追加","                  setInfoW(place, latlng, address);","                  // マーカーにクリックイベントを追加","                  markerEvent();","                }","              }","            } else if (status == google.maps.GeocoderStatus.ZERO_RESULTS) {","              alert(\"見つかりません\");","            } else {","              console.log(status);","              alert(\"エラー発生\");","            }","          });","","        });","","        // 結果クリアーボタン押下時","        document.getElementById('clear').addEventListener('click', function() {","          deleteMakers();","        });","","      }","","      // マーカーのセットを実施する","      function setMarker(setplace) {","        // 既にあるマーカーを削除","        deleteMakers();","","        var iconUrl = 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png';","          marker = new google.maps.Marker({","            position: setplace,","            map: map,","            icon: iconUrl","          });","        }","","        //マーカーを削除する","        function deleteMakers() {","          if(marker != null){","            marker.setMap(null);","          }","          marker = null;","        }","","        // マーカーへの吹き出しの追加","        function setInfoW(place, latlng, address) {","          infoWindow = new google.maps.InfoWindow({","          content: \"<a href='http://www.google.com/search?q=\" + place + \"' target='_blank'>\" + place + \"</a><br><br>\" + latlng + \"<br><br>\" + address + \"<br><br><a href='http://www.google.com/search?q=\" + place + \"&tbm=isch' target='_blank'>画像検索 by google</a>\"","        });","      }","","      // クリックイベント","      function markerEvent() {","        marker.addListener('click', function() {","          infoWindow.open(map, marker);","        });","      }","","    </script>"],"id":50}],[{"start":{"row":10,"column":0},"end":{"row":11,"column":0},"action":"insert","lines":["",""],"id":51}],[{"start":{"row":12,"column":0},"end":{"row":76,"column":7},"action":"remove","lines":["<style>","#map {","  height: 1200px;","  width: 1200px;","}","</style>","","<script>","let map","let geocoder","// 下の1行を追加","const display = document.getElementById('display')","","function initMap(){","  geocoder = new google.maps.Geocoder()","","  map = new google.maps.Map(document.getElementById('map'), {","    center: {lat: 40.7828, lng:-73.9653},","    zoom: 12,","  });","","  marker = new google.maps.Marker({","    position:  {lat: 40.7828, lng:-73.9653},","    map: map","  });","}","// ここから追加","function codeAddress(){","  let inputAddress = document.getElementById('address').value;","","  geocoder.geocode( { 'address': inputAddress}, function(results, status) {","    if (status == 'OK') {","      map.setCenter(results[0].geometry.location);","      var marker = new google.maps.Marker({","          map: map,","          position: results[0].geometry.location","      });","      // 下の1行を追加","      display.textContent = \"検索結果：\" + results[ 0 ].geometry.location","    } else {","      alert('該当する結果がありませんでした：' + status);","    }","  });","}","</script>","<script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBdP41sy-1Bd4LE3okwEwSTiEDQgVdsHpA&callback=initMap\" async defer></script>","","<!DOCTYPE html>","<html lang=\"ja\">","  <head>","    <meta charset=\"utf-8\">","    <title>Placeサーチ</title>","    <style>","      #header {","    \t  background-color: darkblue;","    \t  padding: 3px;","    \t  width: 1195px;","          font-family: Meriyo UI;","          font-size: 14px;","    \t  color: white;","      }","      #target {","        width: 1200px;","        height: 700px;","      }"],"id":59},{"start":{"row":12,"column":0},"end":{"row":52,"column":42},"action":"insert","lines":["    <div id=\"header\"><b>Google Maps - 場所検索</b></div>","    <div>施設名称検索 （例：マチュピチュ、万里の長城）</div>","    <input type=\"text\" id=\"keyword\"><button id=\"search\">検索実行</button>","    <button id=\"clear\">結果クリア</button>","    <div id=\"target\"></div>","","    <script src=\"https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=キーをセット&callback=initMap\" async defer></script>","","    <script>","","      var map;","      var marker;","      var infoWindow;","","      function initMap() {","","        //マップ初期表示の位置設定","        var target = document.getElementById('target');","        var centerp = {lat: 37.67229496806523, lng: 137.88838989062504};","","        //マップ表示","        map = new google.maps.Map(target, {","          center: centerp,","          zoom: 2,","        });","","        // 検索実行ボタンが押下されたとき","        document.getElementById('search').addEventListener('click', function() {","","          var place = document.getElementById('keyword').value;","          var geocoder = new google.maps.Geocoder();      // geocoderのコンストラクタ","","          geocoder.geocode({","            address: place","          }, function(results, status) {","            if (status == google.maps.GeocoderStatus.OK) {","","              var bounds = new google.maps.LatLngBounds();","","              for (var i in results) {","                if (results[0].geometry) {"]}],[{"start":{"row":52,"column":42},"end":{"row":53,"column":0},"action":"insert","lines":["",""],"id":60},{"start":{"row":53,"column":0},"end":{"row":53,"column":18},"action":"insert","lines":["                  "]}],[{"start":{"row":53,"column":16},"end":{"row":53,"column":18},"action":"remove","lines":["  "],"id":61},{"start":{"row":53,"column":14},"end":{"row":53,"column":16},"action":"remove","lines":["  "]},{"start":{"row":53,"column":12},"end":{"row":53,"column":14},"action":"remove","lines":["  "]},{"start":{"row":53,"column":10},"end":{"row":53,"column":12},"action":"remove","lines":["  "]},{"start":{"row":53,"column":8},"end":{"row":53,"column":10},"action":"remove","lines":["  "]},{"start":{"row":53,"column":6},"end":{"row":53,"column":8},"action":"remove","lines":["  "]},{"start":{"row":53,"column":4},"end":{"row":53,"column":6},"action":"remove","lines":["  "]},{"start":{"row":53,"column":2},"end":{"row":53,"column":4},"action":"remove","lines":["  "]}],[{"start":{"row":53,"column":2},"end":{"row":86,"column":22},"action":"insert","lines":["                  // 緯度経度を取得","                  var latlng = results[0].geometry.location;","                  // 住所を取得","                  var address = results[0].formatted_address;","                  // 検索結果地が含まれるように範囲を拡大","                  bounds.extend(latlng);","                  // マーカーのセット","                  setMarker(latlng);","                  // マーカーへの吹き出しの追加","                  setInfoW(place, latlng, address);","                  // マーカーにクリックイベントを追加","                  markerEvent();","                }","              }","            } else if (status == google.maps.GeocoderStatus.ZERO_RESULTS) {","              alert(\"見つかりません\");","            } else {","              console.log(status);","              alert(\"エラー発生\");","            }","          });","","        });","","        // 結果クリアーボタン押下時","        document.getElementById('clear').addEventListener('click', function() {","          deleteMakers();","        });","","      }","","      // マーカーのセットを実施する","      function setMarker(setplace) {","        // 既にあるマーカーを削除"],"id":62}],[{"start":{"row":86,"column":22},"end":{"row":87,"column":0},"action":"insert","lines":["",""],"id":63},{"start":{"row":87,"column":0},"end":{"row":87,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":87,"column":6},"end":{"row":87,"column":8},"action":"remove","lines":["  "],"id":64},{"start":{"row":87,"column":4},"end":{"row":87,"column":6},"action":"remove","lines":["  "]},{"start":{"row":87,"column":2},"end":{"row":87,"column":4},"action":"remove","lines":["  "]}],[{"start":{"row":87,"column":2},"end":{"row":119,"column":13},"action":"insert","lines":["        deleteMakers();","","        var iconUrl = 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png';","          marker = new google.maps.Marker({","            position: setplace,","            map: map,","            icon: iconUrl","          });","        }","","        //マーカーを削除する","        function deleteMakers() {","          if(marker != null){","            marker.setMap(null);","          }","          marker = null;","        }","","        // マーカーへの吹き出しの追加","        function setInfoW(place, latlng, address) {","          infoWindow = new google.maps.InfoWindow({","          content: \"<a href='http://www.google.com/search?q=\" + place + \"' target='_blank'>\" + place + \"</a><br><br>\" + latlng + \"<br><br>\" + address + \"<br><br><a href='http://www.google.com/search?q=\" + place + \"&tbm=isch' target='_blank'>画像検索 by google</a>\"","        });","      }","","      // クリックイベント","      function markerEvent() {","        marker.addListener('click', function() {","          infoWindow.open(map, marker);","        });","      }","","    </script>"],"id":66}],[{"start":{"row":120,"column":11},"end":{"row":120,"column":12},"action":"remove","lines":[">"],"id":67},{"start":{"row":120,"column":10},"end":{"row":120,"column":11},"action":"remove","lines":["e"]},{"start":{"row":120,"column":9},"end":{"row":120,"column":10},"action":"remove","lines":["l"]},{"start":{"row":120,"column":8},"end":{"row":120,"column":9},"action":"remove","lines":["y"]},{"start":{"row":120,"column":7},"end":{"row":120,"column":8},"action":"remove","lines":["t"]},{"start":{"row":120,"column":6},"end":{"row":120,"column":7},"action":"remove","lines":["s"]},{"start":{"row":120,"column":5},"end":{"row":120,"column":6},"action":"remove","lines":["/"]},{"start":{"row":120,"column":4},"end":{"row":120,"column":5},"action":"remove","lines":["<"]},{"start":{"row":120,"column":2},"end":{"row":120,"column":4},"action":"remove","lines":["  "]},{"start":{"row":120,"column":0},"end":{"row":120,"column":2},"action":"remove","lines":["  "]},{"start":{"row":119,"column":13},"end":{"row":120,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":18,"column":83},"end":{"row":18,"column":89},"action":"remove","lines":["キーをセット"],"id":69},{"start":{"row":18,"column":83},"end":{"row":18,"column":122},"action":"insert","lines":["AIzaSyBdP41sy-1Bd4LE3okwEwSTiEDQgVdsHpA"]}],[{"start":{"row":0,"column":0},"end":{"row":126,"column":7},"action":"remove","lines":["","<h2>gmap</h2>","","<!-- ここから追加 -->","<input id=\"address\" type=\"textbox\" value=\"GeekSalon\">","<input type=\"button\" value=\"Encode\" onclick=\"codeAddress()\">","<!-- ここまで追加-->","<div id=\"display\">何かが表示される、、、、！</div>","","<div id='map'></div>","","","    <div id=\"header\"><b>Google Maps - 場所検索</b></div>","    <div>施設名称検索 （例：マチュピチュ、万里の長城）</div>","    <input type=\"text\" id=\"keyword\"><button id=\"search\">検索実行</button>","    <button id=\"clear\">結果クリア</button>","    <div id=\"target\"></div>","","    <script src=\"https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=AIzaSyBdP41sy-1Bd4LE3okwEwSTiEDQgVdsHpA&callback=initMap\" async defer></script>","","    <script>","","      var map;","      var marker;","      var infoWindow;","","      function initMap() {","","        //マップ初期表示の位置設定","        var target = document.getElementById('target');","        var centerp = {lat: 37.67229496806523, lng: 137.88838989062504};","","        //マップ表示","        map = new google.maps.Map(target, {","          center: centerp,","          zoom: 2,","        });","","        // 検索実行ボタンが押下されたとき","        document.getElementById('search').addEventListener('click', function() {","","          var place = document.getElementById('keyword').value;","          var geocoder = new google.maps.Geocoder();      // geocoderのコンストラクタ","","          geocoder.geocode({","            address: place","          }, function(results, status) {","            if (status == google.maps.GeocoderStatus.OK) {","","              var bounds = new google.maps.LatLngBounds();","","              for (var i in results) {","                if (results[0].geometry) {","                    // 緯度経度を取得","                  var latlng = results[0].geometry.location;","                  // 住所を取得","                  var address = results[0].formatted_address;","                  // 検索結果地が含まれるように範囲を拡大","                  bounds.extend(latlng);","                  // マーカーのセット","                  setMarker(latlng);","                  // マーカーへの吹き出しの追加","                  setInfoW(place, latlng, address);","                  // マーカーにクリックイベントを追加","                  markerEvent();","                }","              }","            } else if (status == google.maps.GeocoderStatus.ZERO_RESULTS) {","              alert(\"見つかりません\");","            } else {","              console.log(status);","              alert(\"エラー発生\");","            }","          });","","        });","","        // 結果クリアーボタン押下時","        document.getElementById('clear').addEventListener('click', function() {","          deleteMakers();","        });","","      }","","      // マーカーのセットを実施する","      function setMarker(setplace) {","        // 既にあるマーカーを削除","          deleteMakers();","","        var iconUrl = 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png';","          marker = new google.maps.Marker({","            position: setplace,","            map: map,","            icon: iconUrl","          });","        }","","        //マーカーを削除する","        function deleteMakers() {","          if(marker != null){","            marker.setMap(null);","          }","          marker = null;","        }","","        // マーカーへの吹き出しの追加","        function setInfoW(place, latlng, address) {","          infoWindow = new google.maps.InfoWindow({","          content: \"<a href='http://www.google.com/search?q=\" + place + \"' target='_blank'>\" + place + \"</a><br><br>\" + latlng + \"<br><br>\" + address + \"<br><br><a href='http://www.google.com/search?q=\" + place + \"&tbm=isch' target='_blank'>画像検索 by google</a>\"","        });","      }","","      // クリックイベント","      function markerEvent() {","        marker.addListener('click', function() {","          infoWindow.open(map, marker);","        });","      }","","    </script>","  </head>","","  <body>","","","  </body>","</html>"],"id":70},{"start":{"row":0,"column":0},"end":{"row":108,"column":9},"action":"insert","lines":["<h2>Google map</h2>","","<input id=\"address\" type=\"textbox\" value=\"\">","<input type=\"button\" value=\"地図を検索\" onclick=\"codeAddress()\">","<div id=\"display\">緯度経度が表示されるよ！</div>","","<div id='map'></div>","","<style>","    #map {","        height: 400px;","        width: 400px;","    }","</style>","","<script>","    let map","","    const display = document.getElementById('display')","","    // mapの表示関数 ","    function initMap() {","        geocoder = new google.maps.Geocoder()","","        // mapの初期位置, 縮尺を定義","        map = new google.maps.Map(document.getElementById('map'), {","            center: {","                lat: 35.6458437,","                lng: 139.7046171","            },","            zoom: 12,","        });","","        // mapsテーブルにあるそれぞれのレコードをmap上に表示 ","        <% @maps.each do |m| %>","            (function(){","            var contentString = \"住所：<%= m.address %>\"; ","","            // マーカーを立てる","            var marker = new google.maps.Marker({","                position:{lat: <%= m.latitude %>, lng: <%= m.longitude %>},","                map: map,","                title: contentString","            });","","            // 情報ウィンドウ(吹き出し)の定義","            // 投稿の詳細ページへのリンクも","            var infowindow = new google.maps.InfoWindow({","            position: {lat: <%= m.latitude %>, lng: <%= m.longitude %>},","            content: \"<a href='<%= map_url(m.id) %>' target='_blank'><%= m.address %></a>\"","            });","","            // クリックしたときに情報ウィンドウを表示","            marker.addListener('click', function() {","            infowindow.open(map, marker);","            });","","            })();","        <% end %>","    }","","    let geocoder","","    // 地図検索関数","    function codeAddress() {","        let inputAddress = document.getElementById('address').value;","","        geocoder.geocode({","            'address': inputAddress","        }, function (results, status) {","            if (status == 'OK') {","                map.setCenter(results[0].geometry.location);","                var marker = new google.maps.Marker({","                    map: map,","                    position: results[0].geometry.location","                });","","            display.textContent = \"検索結果：\" + results[ 0 ].geometry.location","            } else {","                alert('該当する結果がありませんでした：' + status);","            }","        });","    }","</script>","","<script","    src=\"https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap\"  ","    async defer>","</script>","","<h3>場所投稿フォーム</h3>","<%= form_for(@map, :url => { controller:'maps', action:'create'})do |f| %>","","    <p>","    <%= f.label :address %>","    <%= f.text_field :address, size: \"50x1\" %>","    </p>","","    <%= f.submit \"送信\"%>","<% end %>","","<h3>場所一覧</h3>","<% @maps.each do |t| %>","    <p>住所 : <%= t.address %></p>","    <p>緯度 : <%= t.latitude %></p>","    <p>経度 : <%= t.longitude %></p>","    <p><%= link_to \"削除する\", map_path(t.id), method: :delete %></p>","    <hr>","<% end %>"]}],[{"start":{"row":20,"column":15},"end":{"row":20,"column":16},"action":"remove","lines":[" "],"id":71},{"start":{"row":33,"column":39},"end":{"row":33,"column":40},"action":"remove","lines":[" "]},{"start":{"row":36,"column":54},"end":{"row":36,"column":55},"action":"remove","lines":[" "]},{"start":{"row":86,"column":103},"end":{"row":86,"column":105},"action":"remove","lines":["  "]}],[{"start":{"row":11,"column":15},"end":{"row":11,"column":16},"action":"remove","lines":["4"],"id":72}],[{"start":{"row":11,"column":15},"end":{"row":11,"column":16},"action":"insert","lines":["1"],"id":73},{"start":{"row":11,"column":16},"end":{"row":11,"column":17},"action":"insert","lines":["0"]}],[{"start":{"row":10,"column":16},"end":{"row":10,"column":17},"action":"remove","lines":["4"],"id":74}],[{"start":{"row":10,"column":16},"end":{"row":10,"column":17},"action":"insert","lines":["6"],"id":75}]]},"ace":{"folds":[],"scrolltop":971.5,"scrollleft":0,"selection":{"start":{"row":10,"column":17},"end":{"row":10,"column":17},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":59,"state":"js-no_regex","mode":"ace/mode/html_ruby"}},"timestamp":1664103156483,"hash":"61b7b9aeb37242ada1a6be898cca3bbde5b161d4"}